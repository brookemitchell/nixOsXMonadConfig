--xmonad.hs: Configuration file for xmonad
import XMonad
import XMonad.Hooks.EwmhDesktops (ewmh)
import XMonad.Hooks.ManageDocks
import System.Taffybar.Hooks.PagerHints (pagerHints)
import XMonad.Layout.Spacing
import XMonad.Util.CustomKeys
import XMonad.Util.SpawnOnce
import Graphics.X11.ExtraTypes.XF86
import XMonad.Prompt

import XMonad.StackSet as W
import XMonad.ManageHook
import XMonad.Util.NamedScratchpad

import XMonad.Actions.DynamicWorkspaces
import XMonad.Actions.CopyWindow(copy)



-- myTerminal           = "termite"
myTerminal = "urxvt"
-- myModMask            = mod4Mask
myBorderWidth        = 3
myFocusedBorderColor = "#5294EA" 

myStartupHook = do
        spawnOnce "nitrogen --restore&"
        spawnOnce "xsetroot -cursor_name left_ptr &"
        spawnOnce "xrdb -merge ~/.XResources"
        spawnOnce "taffybar"

delKeys :: XConfig l -> [(KeyMask, KeySym)]
delKeys conf@(XConfig {modMask = modMask}) =
        [ (modMask,                  xK_p) ]

insKeys :: XConfig l -> [((KeyMask, KeySym), X ())]
insKeys conf@(XConfig {modMask = modMask}) =
        [   ((modMask,                xK_p),         spawn "rofi -combi-modi window,run -show combi")
          , ((modMask,                xK_e),         spawn "emacsclient -c")
          , ((controlMask,            xK_backslash), spawn "/home/hoodoo/local/bin/switch.sh")
          , ((modMask,                xK_minus),     namedScratchpadAction scratchpads "HipChat")
          , ((0 , xF86XK_AudioRaiseVolume),          spawn "pactl set-sink-volume @DEFAULT_SINK@ +5%")
          , ((0 , xF86XK_AudioLowerVolume),          spawn "pactl set-sink-volume @DEFAULT_SINK@ -5%")
          , ((0 , xF86XK_AudioMute),                 spawn "pactl set-sink-mute   @DEFAULT_SINK@ toggle")
          , ((modMask .|. shiftMask, xK_BackSpace), removeWorkspace)
          , ((modMask .|. shiftMask, xK_v      ), selectWorkspace defaultXPConfig)
          , ((modMask, xK_m                    ), withWorkspace defaultXPConfig (windows . W.shift))
          , ((modMask .|. shiftMask, xK_m      ), withWorkspace defaultXPConfig (windows . copy))
          , ((modMask .|. shiftMask, xK_r      ), renameWorkspace defaultXPConfig)
          , ((modMask .|. shiftMask, xK_w      ), addWorkspacePrompt defaultXPConfig)
         ]

scratchpads = [
        NS "HipChat" "HipChat" (className =? "HipChat")
                (customFloating $ W.RationalRect (1/6) (1/6) (2/3) (2/3))
        ]  where role = stringProperty "WM_WINDOW_ROLE"

main = do
  xmonad 
  $ ewmh 
  $ pagerHints $
  defaultConfig
    { terminal           = myTerminal
    -- , modMask            = myModMask
    , borderWidth        = myBorderWidth
    , focusedBorderColor = myFocusedBorderColor
    , manageHook         = manageDocks <+> namedScratchpadManageHook scratchpads
    , layoutHook         = spacing 6 $ avoidStruts $ layoutHook defaultConfig
    , startupHook        = myStartupHook
    , keys               = customKeys delKeys insKeys
    }
